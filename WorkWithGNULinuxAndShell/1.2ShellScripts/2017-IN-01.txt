Ð—Ð°Ð´. 23 2017-IN-01 ÐÐ°Ð¿Ð¸ÑˆÐµÑ‚Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚, ÐºÐ¾Ð¹Ñ‚Ð¾ Ð¿Ñ€Ð¸ÐµÐ¼Ð° Ñ‚Ñ€Ð¸ Ð·Ð°Ð´ÑŠÐ»Ð¶Ð¸Ñ‚ÐµÐ»Ð½Ð¸ Ð¿Ð¾Ð·Ð¸Ñ†Ð¾Ð½Ð½Ð¸ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚Ð°:
â€¢ Ð¸Ð¼Ðµ Ð½Ð° Ñ„Ð°Ð¸Ð»
â€¢ Ð½Ð¸Ð·1
â€¢ Ð½Ð¸Ð·2
Ð¤Ð°Ð¹Ð»ÑŠÑ‚ Ðµ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ð¸, Ð¸ ÑÑŠÐ´ÑŠÑ€Ð¶Ð° Ñ€ÐµÐ´Ð¾Ð²Ðµ Ð²ÑŠÐ² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚:
ÐºÐ»ÑŽÑ‡=ÑÑ‚Ð¾Ð¹Ð½Ð¾ÑÑ‚
ÐºÑŠÐ´ÐµÑ‚Ð¾ ÑÑ‚Ð¾Ð¹Ð½Ð¾ÑÑ‚ Ð¼Ð¾Ð¶Ðµ Ð´Ð° Ð±ÑŠÐ´Ðµ:
â€¢ Ð¿Ñ€Ð°Ð·ÐµÐ½ Ð½Ð¸Ð·, Ñ‚.Ðµ. Ñ€ÐµÐ´ÑŠÑ‚ Ðµ ÐºÐ»ÑŽÑ‡=
â€¢ Ð½Ð¸Ð·, ÑÑŠÑÑ‚Ð¾ÑÑ‰ ÑÐµ Ð¾Ñ‚ ÐµÐ´Ð¸Ð½ Ð¸Ð»Ð¸ Ð¿Ð¾Ð²ÐµÑ‡Ðµ Ñ‚ÐµÑ€Ð¼Ð¾Ð²Ðµ, Ñ€Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¸ Ñ Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð»Ð¸, Ñ‚.Ðµ., Ñ€ÐµÐ´ÑŠÑ‚ Ðµ ÐºÐ»ÑŽÑ‡=ð‘¡1
ð‘¡2
ð‘¡3
ÐÑÐºÑŠÐ´Ðµ Ð²ÑŠÐ² Ñ„Ð°Ð¹Ð»Ð°:
â€¢ ÑÐµ ÑÑŠÐ´ÑŠÑ€Ð¶Ð° ÐµÐ´Ð¸Ð½ Ñ€ÐµÐ´ Ñ ÐºÐ»ÑŽÑ‡ Ð¿ÑŠÑ€Ð²Ð¸Ñ Ð¿Ð¾Ð´Ð°Ð´ÐµÐ½ Ð½Ð¸Ð· (Ð½Ð¸Ð·1);
â€¢ Ð¸ Ð¼Ð¾Ð¶Ðµ Ð´Ð° ÑÐµ ÑÑŠÐ´ÑŠÑ€Ð¶Ð° ÐµÐ´Ð¸Ð½ Ñ€ÐµÐ´ Ñ ÐºÐ»ÑŽÑ‡ Ð²Ñ‚Ð¾Ñ€Ð¸Ñ Ð¿Ð¾Ð´Ð°Ð´ÐµÐ½ Ð½Ð¸Ð· (Ð½Ð¸Ð·2).
Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ÑŠÑ‚ Ñ‚Ñ€ÑÐ±Ð²Ð° Ð´Ð° Ð¿Ñ€Ð¾Ð¼ÐµÐ½Ñ Ñ€ÐµÐ´Ð° Ñ ÐºÐ»ÑŽÑ‡ Ð½Ð¸Ð·2 Ñ‚Ð°ÐºÐ°, Ñ‡Ðµ Ð¾Ð±ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸ÐµÑ‚Ð¾ Ð½Ð° Ñ‚ÐµÑ€Ð¼Ð¾Ð²ÐµÑ‚Ðµ Ð½Ð° Ñ€ÐµÐ´Ð¾Ð²ÐµÑ‚Ðµ Ñ ÐºÐ»ÑŽÑ‡Ð¾Ð²Ðµ Ð½Ð¸Ð·1 Ð¸ Ð½Ð¸Ð·2 Ð´Ð° Ð²ÐºÐ»ÑŽÑ‡Ð²Ð° Ð²ÑÐµÐºÐ¸ Ñ‚ÐµÑ€Ð¼ ÐµÐ´Ð½Ð¾ÐºÑ€Ð°Ñ‚Ð½Ð¾.
ÐŸÑ€Ð¸Ð¼ÐµÑ€ÐµÐ½ Ð²Ñ…Ð¾Ð´ÐµÐ½ Ñ„Ð°Ð¹Ð»:
$ cat z1.txt
FOO=73
BAR=42
BAZ=
ENABLED_OPTIONS=a b c d
ENABLED_OPTIONS_EXTRA=c e f
ÐŸÑ€Ð¸Ð¼ÐµÑ€Ð½Ð¾ Ð¸Ð·Ð²Ð¸ÐºÐ²Ð°Ð½Ðµ:
$ ./a.sh z1.txt ENABLED_OPTIONS ENABLED_OPTIONS_EXTRA
Ð˜Ð·Ñ…Ð¾Ð´ÐµÐ½ Ñ„Ð°Ð¹Ð»:
$ cat z1.txt
FOO=73
BAR=42
BAZ=
ENABLED_OPTIONS=a b c d
ENABLED_OPTIONS_EXTRA=e f

------------------------------------------------------------------------
#!/bin/bash

[[ "$#" -ne 3 ]] && echo "Invalid cnt args. Must be 3!" >&2 && exit 1
[[ ! -e "$1" ]] && echo "File $1 does not exist!" >&2 && exit 2

file="$1"
key1="$2"
key2="$3"

val1=$(grep -E "^$key1=" "$file" | cut -d'=' -f2-)
val2=$(grep -E "^$key2=" "$file" | cut -d'=' -f2-)

[[ -z "$val1" ]] && echo "There is no key $2 in file!" >&2 && exit 3
[[ -z "$val2" ]] && exit 0

res=$(awk -v v1="$val1" -v v2="$val2" '
BEGIN {
    split(v1, a, " ")
    for (i in a) seen[a[i]] = 1

    split(v2, b, " ")
    for (i in b)
        if (!(b[i] in seen))
            printf "%s%s", (out++ ? " " : ""), b[i]
}
')

> temp.txt
cat "$file" | while IFS='=' read -r k v; do
    if [[ "$k" == "$key2" ]]; then
        echo "$k=$res" >> temp.txt
    else
        echo "$k=$v" >> temp.txt
    fi
done

cp temp.txt "$file"
rm temp.txt

cat "$file"
exit 0